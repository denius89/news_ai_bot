# telegram_bot/handlers/start.py
from aiogram import types, Router
from aiogram.filters import Command

from telegram_bot.keyboards import start_inline_keyboard, main_inline_keyboard

router = Router()

WELCOME_TEXT = (
    "üëã –ü—Ä–∏–≤–µ—Ç! –Ø <b>PulseAI</b> ‚Äî —Ç–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –Ω–æ–≤–æ—Å—Ç–µ–π ü§ñ\n\n"
    "–Ø –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é <b>255 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤</b> –∏ —Å–æ–∑–¥–∞—é –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–π–¥–∂–µ—Å—Ç—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ–±—è.\n\n"
    "üìå <b>–ß—Ç–æ —è —É–º–µ—é:</b>\n\n"
    "üì∞ <b>–ù–æ–≤–æ—Å—Ç–∏</b>\n"
    "   ‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏–∑ 70 –∫–∞—Ç–µ–≥–æ—Ä–∏–π\n"
    "   ‚Ä¢ AI-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏ –∏ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç–∏\n\n"
    "ü§ñ <b>AI-–¥–∞–π–¥–∂–µ—Å—Ç</b>\n"
    "   ‚Ä¢ 4 –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å—Ç–∏–ª—è: newsroom, analytical, magazine, casual\n"
    "   ‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥ —Ç–≤–æ–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã\n"
    "   ‚Ä¢ –°–∏—Å—Ç–µ–º–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Å ML-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π\n\n"
    "üìÖ <b>–°–æ–±—ã—Ç–∏—è</b>\n"
    "   ‚Ä¢ –£–º–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å AI-–æ—Ü–µ–Ω–∫–æ–π –≤–∞–∂–Ω–æ—Å—Ç–∏\n"
    "   ‚Ä¢ 20+ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤: crypto, sports, markets, tech\n"
    "   ‚Ä¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫–ª—é—á–µ–≤—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö\n\n"
    "üåê <b>WebApp Dashboard</b>\n"
    "   ‚Ä¢ –ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏\n"
    "   ‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π\n"
    "   ‚Ä¢ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π\n\n"
    "‚öôÔ∏è <b>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</b>\n"
    "   ‚Ä¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –ø–æ–¥–ø–∏—Å–æ–∫\n"
    "   ‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π\n"
    "   ‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞\n\n"
    "‚ú® <b>–ù–∞—á–Ω—ë–º?</b> –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ üëá"
)


@router.message(Command("start"))
async def cmd_start(message: types.Message):
    """–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + –∫–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞"""
    await message.answer(WELCOME_TEXT, parse_mode="HTML", reply_markup=start_inline_keyboard())


@router.callback_query(lambda c: c.data == "start")
async def cb_start(query: types.CallbackQuery):
    """–ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"""
    await query.message.edit_text("üìå –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_inline_keyboard())
    await query.answer()


@router.callback_query(lambda c: c.data == "back")
async def cb_back(query: types.CallbackQuery):
    """–í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"""
    await query.message.edit_text("üìå –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_inline_keyboard())
    await query.answer()


@router.callback_query(lambda c: c.data == "settings")
async def cb_settings(query: types.CallbackQuery):
    """–ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫"""
    from telegram_bot.keyboards import settings_inline_keyboard

    settings_text = (
        "‚öôÔ∏è <b>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ PulseAI</b>\n\n"
        "–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–æ–¥ —Å–µ–±—è:\n\n"
        "üìã <b>–ü–æ–¥–ø–∏—Å–∫–∏</b>\n"
        "   ‚Ä¢ 2-—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞: –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏\n"
        "   ‚Ä¢ 70 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ –≤—ã–±–æ—Ä\n"
        "   ‚Ä¢ –î–æ–±–∞–≤–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏\n"
        "   ‚Ä¢ –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫\n\n"
        "üîî <b>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</b>\n"
        "   ‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –¥–∞–π–¥–∂–µ—Å—Ç–∞—Ö\n"
        "   ‚Ä¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö\n"
        "   ‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Ä–µ–º–µ–Ω–∏\n\n"
        "üí° –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ WebApp Dashboard"
    )
    await query.message.edit_text(settings_text, parse_mode="HTML", reply_markup=settings_inline_keyboard())
    await query.answer()


@router.callback_query(lambda c: c.data == "help")
async def cb_help(query: types.CallbackQuery):
    """–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É"""
    help_text = (
        "üìñ <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ PulseAI</b>\n\n"
        "<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        "‚Ä¢ /start ‚Äî –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ\n"
        "‚Ä¢ /digest_ai ‚Äî AI-–¥–∞–π–¥–∂–µ—Å—Ç —Å –≤—ã–±–æ—Ä–æ–º —Å—Ç–∏–ª—è\n"
        "‚Ä¢ /events ‚Äî –∫–∞–ª–µ–Ω–¥–∞—Ä—å –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π\n"
        "‚Ä¢ /dashboard ‚Äî –æ—Ç–∫—Ä—ã—Ç—å WebApp Dashboard\n"
        "‚Ä¢ /notifications ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏\n"
        "‚Ä¢ /subscribe <–∫–∞—Ç–µ–≥–æ—Ä–∏—è> ‚Äî –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è\n"
        "‚Ä¢ /my_subs ‚Äî –º–æ–∏ –ø–æ–¥–ø–∏—Å–∫–∏\n\n"
        "<b>üí° –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</b>\n\n"
        "<b>üì∞ –ù–æ–≤–æ—Å—Ç–∏:</b>\n"
        "‚Ä¢ 255 RSS-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤ 70 –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö\n"
        "‚Ä¢ ML-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏ ‚â• 0.6\n"
        "‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç–∏ ‚â• 0.7\n\n"
        "<b>ü§ñ AI-–¥–∞–π–¥–∂–µ—Å—Ç—ã:</b>\n"
        "‚Ä¢ <i>newsroom</i> ‚Äî –∫–∞–∫ Reuters/Bloomberg\n"
        "‚Ä¢ <i>analytical</i> ‚Äî –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑\n"
        "‚Ä¢ <i>magazine</i> ‚Äî storytelling —Å—Ç–∏–ª—å\n"
        "‚Ä¢ <i>casual</i> ‚Äî —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç\n\n"
        "<b>üìÖ –°–æ–±—ã—Ç–∏—è:</b>\n"
        "‚Ä¢ 20+ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (crypto, sports, tech)\n"
        "‚Ä¢ AI-–æ—Ü–µ–Ω–∫–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏–π\n"
        "‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\n\n"
        "<b>üåê WebApp:</b>\n"
        "‚Ä¢ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å\n"
        "‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π\n"
        "‚Ä¢ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏\n\n"
        "<b>‚ö° –°–æ–≤–µ—Ç—ã:</b>\n"
        "‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏\n"
        "‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ –ù–∞—Å—Ç—Ä–æ–π–∫–∏\n"
        "‚Ä¢ WebApp –¥–∞—ë—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–æ–π\n"
        "‚Ä¢ AI-–¥–∞–π–¥–∂–µ—Å—Ç—ã –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ –≤–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã"
    )
    await query.message.edit_text(help_text, parse_mode="HTML", reply_markup=main_inline_keyboard())
    await query.answer()
