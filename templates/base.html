<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="PulseAI — умные дайджесты и события с искусственным интеллектом">
    <title>{{ title or "PulseAI - AI-Powered News & Events" }}</title>
    
    <!-- PULSE: Centralized head includes -->
    {% include 'includes/head.html' %}
</head>
<body>
    <!-- Site Header -->
    <header class="pulse-header">
        <div class="container">
            <!-- Logo Section -->
            <div class="logo-section">
                <a href="/" class="pulse-logo">
                    <h1>PulseAI</h1>
                </a>
            </div>

            <!-- Navigation -->
            <nav class="pulse-nav">
                <a href="/" class="{% if active_page == 'home' %}active{% endif %}">Главная</a>
                <a href="/digest" class="{% if active_page == 'digest' %}active{% endif %}">Дайджест</a>
                <a href="/events" class="{% if active_page == 'events' %}active{% endif %}">События</a>
                <a href="/live" class="{% if active_page == 'live' %}active{% endif %}">⚡ Live</a>
                
                <!-- Theme Toggle -->
                <button class="theme-toggle" onclick="toggleTheme()" title="Переключить тему">
                    <svg class="theme-icon-light" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"/>
                        <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                    </svg>
                    <svg class="theme-icon-dark" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                    </svg>
                </button>
            </nav>
        </div>
    </header>

    <!-- Subnav (filters, etc.) -->
    {% block subnav %}{% endblock %}

    <!-- Page Content -->
    <main class="page-content">
        {% block content %}{% endblock %}
    </main>

    <!-- PulseAI Reactor Scripts -->
    {% include 'includes/scripts.html' %}
    
    <!-- Reactor Components JavaScript -->
    <script src="{{ url_for('static', filename='js/components.js') }}"></script>
    
    <!-- Reactor Components -->
    {% block reactor_components %}{% endblock %}
    
    <!-- JavaScript -->
    <script>
        // Интерактивность для табов (chip-filter)
        document.addEventListener('DOMContentLoaded', function() {
            const chipFilters = document.querySelectorAll('.chip-filter');
            
            chipFilters.forEach(chip => {
                chip.addEventListener('click', function(e) {
                    // Плавная анимация
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 100);
                    
                    // НЕ перехватываем клик - позволяем браузеру перейти по ссылке
                    // Визуальное состояние будет обновлено после загрузки новой страницы
                });
            });
        });
    </script>
</body>
</html>