<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#1E3A8A">
    <meta name="description" content="PulseAI — умные дайджесты и события с искусственным интеллектом">
    <title>Pulse AI</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="{{ url_for('static', filename='assets/logo/site.webmanifest') }}">
    
    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='assets/logo/logo_icon_180.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='assets/logo/logo_icon_32.png') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='assets/logo/logo_icon_16.png') }}">
    <link rel="icon" href="{{ url_for('static', filename='assets/logo/favicon.ico') }}" sizes="any">
    
    <!-- Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='webapp.css') }}?v=1.0">
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Additional PWA Meta Tags -->
    <meta name="application-name" content="PulseAI">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="PulseAI">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#1E3A8A">
</head>
<body>
  <header class="webapp-header">
    <div class="header-logo">
      <img src="{{ url_for('static', filename='assets/logo/logo_icon_32.png') }}" alt="PulseAI">
      <h1 class="header-title">PulseAI Dashboard</h1>
    </div>
    <div class="ai-badge">AI</div>
  </header>

  <main id="webapp-content">
    <section id="subscriptions" class="tab-content active">
      <div class="content-header">
        <h2>Subscriptions</h2>
        <p class="content-subtitle">Choose topics you're interested in</p>
      </div>
      <div class="subscription-list" id="subscription-list">
        <!-- Categories will be rendered here by JavaScript -->
      </div>
    </section>
    
    <section id="notifications" class="tab-content">
      <div class="content-header">
        <h2>Notifications</h2>
        <div class="notifications-tabs">
          <button class="tab-btn active" data-mode="view">
            <i data-lucide="inbox"></i>
            <span>View</span>
          </button>
          <button class="tab-btn" data-mode="settings">
            <i data-lucide="settings"></i>
            <span>Settings</span>
          </button>
        </div>
      </div>
      
      <!-- Notifications View Mode -->
      <div class="notifications-mode active" id="notifications-view">
        <!-- Unread notifications section -->
        <div class="notification-section" id="unread-section">
          <div class="section-header">
            <h3>📮 Unread</h3>
            <span class="unread-badge" id="unread-badge">0</span>
          </div>
          <div class="notifications-list" id="unread-notifications">
            <!-- Unread notifications will be rendered here -->
          </div>
        </div>

        <!-- Read notifications section -->
        <div class="notification-section" id="history-section">
          <div class="section-header">
            <h3>📋 History</h3>
            <span class="section-subtitle">Previously read notifications</span>
          </div>
          <div class="notifications-list" id="read-notifications">
            <!-- Read notifications will be rendered here -->
          </div>
        </div>
      </div>
      
      <!-- Notifications Settings Mode -->
      <div class="notifications-mode" id="notifications-settings">
        <div class="content-subtitle">
          <p>Manage your notification preferences</p>
        </div>
        <div class="notification-settings-list" id="notification-settings-list">
          <!-- Settings will be rendered here by JavaScript -->
        </div>
      </div>
    </section>
    
    <section id="calendar" class="tab-content">
      <h2>Calendar</h2>
      <p>Calendar UI placeholder</p>
    </section>
  </main>

  <nav class="webapp-nav">
    <button data-tab="subscriptions" class="nav-btn active">
      <i data-lucide="bookmark"></i>
      <span>Subscriptions</span>
    </button>
    <button data-tab="notifications" class="nav-btn">
      <i data-lucide="bell"></i>
      <span>Notifications</span>
      <span class="notification-badge" id="nav-notification-badge">0</span>
    </button>
    <button data-tab="calendar" class="nav-btn">
      <i data-lucide="calendar"></i>
      <span>Calendar</span>
    </button>
    <button class="nav-btn back-to-bot" id="back-to-bot">
      <i data-lucide="arrow-left-circle"></i>
      <span>Back to Bot</span>
    </button>
  </nav>

  <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/webapp.js') }}?v=8.0"></script>
</body>
</html>
