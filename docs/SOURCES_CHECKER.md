# –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ RSS –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

## –û–ø–∏—Å–∞–Ω–∏–µ

`tools/check_sources.py` - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ RSS –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞ `config/sources.yaml`. –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã —Å —Ç–∞–π–º–∞—É—Ç–∞–º–∏ –∏ —Ä–µ—Ç—Ä–∞—è–º–∏, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å RSS/Atom —Ñ–∏–¥–æ–≤.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** - –¥–æ 20 –ø–æ—Ç–æ–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- ‚úÖ **–£–º–Ω—ã–µ —Ä–µ—Ç—Ä–∞–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã —Å backoff –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
- ‚úÖ **–¢–∞–π–º–∞—É—Ç—ã** - 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å
- ‚úÖ **RSS –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è `<item>` –∏–ª–∏ `<entry>` —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã** - CSV, JSON –∏ Markdown —Ñ–æ—Ä–º–∞—Ç—ã
- ‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ß–µ—Ä–µ–∑ Makefile (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
make check-sources

# –ü–æ–∫–∞–∑–∞—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤
make sources-report
```

### –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫
```bash
python tools/check_sources.py
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏

### –°—Ç–∞—Ç—É—Å—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- **OK** - HTTP 200, –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–æ—Å—Ç—É–ø–µ–Ω
- **OK (No RSS items)** - HTTP 200, –Ω–æ –Ω–µ—Ç RSS —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **OK (Not XML)** - HTTP 200, –Ω–æ –Ω–µ XML –∫–æ–Ω—Ç–µ–Ω—Ç
- **Redirect** - HTTP 3xx —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã
- **Forbidden** - HTTP 403, –¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω
- **Not Found** - HTTP 404, –∏—Å—Ç–æ—á–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω
- **Error: Timeout** - –ø—Ä–µ–≤—ã—à–µ–Ω —Ç–∞–π–º–∞—É—Ç 10 —Å–µ–∫—É–Ω–¥
- **Error: Connection** - –æ—à–∏–±–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- **Error: Request** - –¥—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ –∑–∞–ø—Ä–æ—Å–∞

### –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –æ—Ç—á–µ—Ç—ã

1. **CSV –æ—Ç—á–µ—Ç** (`logs/sources_check.csv`)
   - –î–µ—Ç–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
   - –ö–æ–ª–æ–Ω–∫–∏: category, subcategory, name, url, status, rss_ok, http_status, final_url, elapsed_ms, error

2. **Markdown –æ—Ç—á–µ—Ç** (`logs/sources_check.md`)
   - –°–≤–æ–¥–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   - –¢–æ–ø –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

3. **JSON –æ—Ç—á–µ—Ç** (`logs/sources_check.json`)
   - –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
   - –í–∫–ª—é—á–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏

## –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```
üìà –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞:
   –í—Å–µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: 198
   ‚úÖ OK: 115
   üîÑ Redirect: 0
   üö´ Forbidden: 23
   ‚ùå Not Found: 42
   ‚ö†Ô∏è Error: 18
   üì∞ RSS OK: 99
   üìä –£—Å–ø–µ—à–Ω–æ—Å—Ç—å: 58.1%
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Ç–æ–∫–æ–≤
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `max_workers` –≤ `SourceChecker`:
```python
checker = SourceChecker(max_workers=30)  # –£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 30 –ø–æ—Ç–æ–∫–æ–≤
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∞–π–º–∞—É—Ç–∞
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `timeout` –≤ –º–µ—Ç–æ–¥–µ `check_single_source`:
```python
response = self.session.get(url, timeout=15, allow_redirects=True)  # 15 —Å–µ–∫—É–Ω–¥
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ

### –†–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:
- **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ** - –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- **–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π** –≤ `config/sources.yaml`
- **–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö** —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º –Ω–æ–≤–æ—Å—Ç–µ–π

### –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º
1. **403 Forbidden** - –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –º–æ–≥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–æ–≤
2. **404 Not Found** - —Å—Å—ã–ª–∫–∏ –º–æ–≥–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è
3. **Timeout** - –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã
4. **Connection Error** - –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é –∏–ª–∏ DNS

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ cron –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
# –ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é –≤ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 9:00
0 9 * * 1 cd /path/to/news_ai_bot && make check-sources
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `requests` - HTTP –∫–ª–∏–µ–Ω—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–µ—Ç—Ä–∞–µ–≤
- `urllib3` - –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–µ—Ç—Ä–∞–µ–≤
- `PyYAML` - –¥–ª—è —á—Ç–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `concurrent.futures` - –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **198 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∑–∞ ~30-60 —Å–µ–∫—É–Ω–¥
- **20 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤** –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—Ç—Ä–∞–∏** –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ (429, 5xx)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π User-Agent –±—Ä–∞—É–∑–µ—Ä–∞
- –°–æ–±–ª—é–¥–∞—é—Ç—Å—è —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–≤–∏—Å–∞–Ω–∏—è
- Graceful handling –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫
